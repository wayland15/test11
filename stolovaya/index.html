<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>Столовая — VR</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.css">
<script src="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.js"></script>

<style>
html, body {
  width: 100%;
  height: 100%;
  margin: 0;
  background: #000;
}
#panorama {
  width: 100%;
  height: 100%;
}

/* ===== ЗАГАДКА ===== */
#riddle {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.9);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 999;
}
#riddleBox {
  background: #1f1f1f;
  padding: 30px;
  border-radius: 16px;
  max-width: 420px;
  text-align: center;
  color: #fff;
}
#riddleBox h2 { color: #6ee7b7; margin-top: 0; }
#riddleBox button {
  margin-top: 20px;
  padding: 12px 24px;
  border: none;
  border-radius: 8px;
  background: #6ee7b7;
  color: #000;
  font-weight: bold;
  cursor: pointer;
}
.custom-arrow-container {
  width: 60px;
  height: 60px;
}
</style>
</head>

<body>

<!-- ===== ЗАГАДКА ===== -->
<div id="riddle">
  <div id="riddleBox">
    <h2>Загадка</h2>
    <p>
      Здесь всегда очередь,<br>
      пахнет едой и слышен звон посуды.<br>
      Где ты находишься?
    </p>
    <button onclick="solve()">Ответ: Столовая</button>
  </div>
</div>

<div id="panorama"></div>

<script>
let nextArrow = null;

/* ===== СТРЕЛКА ===== */
function createArrow(hotSpotDiv, args) {
  hotSpotDiv.classList.add('custom-arrow-container');
  hotSpotDiv.style.display = 'none';
  nextArrow = hotSpotDiv;

  const img = document.createElement('img');
  img.src = 'arrow.png';
  img.style.width = '100%';
  img.style.cursor = 'pointer';

  img.onclick = () => {
    window.location.href = args.url;
  };

  hotSpotDiv.appendChild(img);
}

/* ===== РЕШЕНИЕ ЗАГАДКИ ===== */
function solve() {
  document.getElementById('riddle').style.display = 'none';
  if (nextArrow) nextArrow.style.display = 'block';
}

/* ===== PANELLUM ===== */
pannellum.viewer('panorama', {
  type: 'cubemap',
  autoLoad: true,

  cubeMap: [
    'Stolovaya_Front.jpg',
    'Stolovaya_Right.jpg',
    'Stolovaya_Back.jpg',
    'Stolovaya_Left.jpg',
    'Stolovaya_Up.jpg',
    'Stolovaya_Down.jpg'
  ],

  hotSpots: [
    {
      pitch: 0,
      yaw: 180,
      type: 'custom',
      createTooltipFunc: createArrow,
      createTooltipArgs: {
        url: '../hall/index.html' // ← ВОЗВРАТ В ХОЛЛ
      }
    }
  ]
});
</script>

</body>
</html>
